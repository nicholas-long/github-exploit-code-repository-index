#!/bin/bash

SCRIPT_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )

repo=$(echo $1 | awk '{print $1}')
desc=$(echo $1 | cut -d '|' -f 2)

tf=$(mktemp)
rm $tf
mkdir $tf

git clone "https://github.com/$repo" $tf

previewfile=$($SCRIPT_DIR/interesting.sh $tf 2>/dev/null | head -n 1)

clear
echo  "Name:         $repo"
echo  "Description:  $desc"
echo  "Preview:      $previewfile"

bat --color=always "$tf/$previewfile"
find $tf -type f | grep -v .git | xargs bat --color=always

rm -rf $tf

